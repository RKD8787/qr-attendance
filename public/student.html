<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Attendance - QR System</title>
    <meta name="description" content="Student portal for QR-based attendance marking">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://unpkg.com/@supabase/supabase-js@2" defer></script>
    <script src="script.js" defer></script>

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="theme-color" content="#1e5aa8">
</head>
<body>
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-user-graduate"></i>
            </div>
            <h2>Loading Attendance Portal...</h2>
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <header class="header">
        <h1><strong>Dayananda Sagar College Of Engineering</strong></h1>
        <p><i class="fas fa-user-graduate"></i> Student Attendance Portal</p>
    </header>

    <main class="container">
        <div id="student-selection-page" class="page active">
            <div class="student-selection">
                <h2><i class="fas fa-clipboard-check"></i> Mark Your Attendance</h2>

                <div class="session-info-card">
                    <div class="session-details">
                        <h3 id="session-name-display">Loading session...</h3>
                        <p id="course-name-display">Please wait...</p>
                    </div>
                </div>

                <div class="search-section">
                    <div class="search-container">
                        <input type="text"
                               id="student-search"
                               placeholder="Search your name or USN..."
                               autocomplete="off"
                               aria-label="Search for your name or USN">
                        <div class="search-icon" aria-hidden="true">üîç</div>
                    </div>
                </div>

                <div class="student-list-wrapper">
                    <div class="student-list-header">
                        <h3><i class="fas fa-users"></i> Select Your Name</h3>
                        <p>Click on your name to mark attendance</p>
                    </div>

                    <div class="student-list" id="student-list" role="listbox" aria-label="Student list">
                        <div class="loading-students">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Loading students...</span>
                        </div>
                    </div>
                </div>

                <div class="submit-section">
                    <button type="button" class="submit-btn"
                            id="submit-attendance"
                            disabled
                            aria-label="Submit attendance">
                        <i class="fas fa-paper-plane"></i>
                        Submit Attendance
                    </button>

                    <p class="submit-help">
                        <i class="fas fa-info-circle"></i>
                        Select your name from the list above to enable submission
                    </p>
                </div>
            </div>
        </div>

        <div id="success-page" class="page hidden">
            <div class="success-message">
                <div class="checkmark-container">
                    <div class="checkmark">‚úì</div>
                </div>
                <h2><i class="fas fa-check-circle"></i> Attendance Submitted Successfully!</h2>
                <p>Your attendance has been recorded. Thank you!</p>

                <div class="success-details">
                    <div class="detail-item">
                        <i class="fas fa-user"></i>
                        <span>Student: <strong id="success-student-name">-</strong></span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-clock"></i>
                        <span>Time: <strong id="success-timestamp">-</strong></span>
                    </div>
                </div>
            </div>
        </div>

        <div id="error-page" class="page hidden">
            <div class="error-message">
                <div class="error-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h2>Oops! Something went wrong</h2>
                <p id="error-message-text">An unexpected error occurred.</p>

                <div class="error-actions">
                    <button type="button" class="submit-btn" id="try-again-btn">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                </div>
            </div>
        </div>
    </main>

    <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true"></div>
</body>
</html>
